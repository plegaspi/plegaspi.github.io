usingNamespace("Biz.ProductReview2017")["Common"] = {cmpItemListInQueryString: [],getQueryStrings: function () {var result = Biz.ProductReview2017.PageUrlconfig.OrignalUrl.match(new RegExp("[\?\&][^\?\&]+=[^\?\&]+", "g"));if (result == null) {return "";}for (var i = 0; i < result.length; i++) {result[i] = result[i].substring(1);}return result;},submit: function (needtoTop, oldData) {var url = Biz.ProductReview2017.PageUrlconfig.OrignalUrl;var data = Biz.ProductReview2017.PageUrlconfig.getPostData();this.getResponData(url, data, needtoTop, oldData);},getResponData: function (url, data,needtoTop,oldData) {var dataOverlayElement = jQuery(".Community_Content");var filterWithoutReviews = jQuery(".message.no-icon.is-vertical");var addition = filterWithoutReviews.length != 0 ? 60 : 0;var backgorundOverview = jQuery("<div id='reviewbackground' style='background:rgb(100,100,100);opacity:.6;filter:alpha(opacity=60);text-align: center;margin: 0 auto;'></div>").css({top: dataOverlayElement.position().top,left: dataOverlayElement.position().left,zIndex: "200",position: "absolute",width: dataOverlayElement.width(),height: dataOverlayElement.height() + addition,});var loader = jQuery('<div style="vertical-align: middle; top:100px; margin:0 auto" class="loader has-overlay"><i class="fa fa-spinner fa-pulse"></i>LOADING...</div>');backgorundOverview.append(loader);dataOverlayElement.append(backgorundOverview);jQuery.ajax({url: url,processData: false,cache: false,data: data,dataType: 'jsonp',jsonp: "action",jsonpCallback: 'proxy'}).done(function (jsonp) {if(jsonp && jsonp.ReviewList) {var titleHtml = jQuery('#reviewsectionTitle').prop("outerHTML") ? jQuery('#reviewsectionTitle').prop("outerHTML") : '';var sumaryHtml = jQuery('#ReviewSummaryContent').prop("outerHTML") ? jQuery('#ReviewSummaryContent').prop("outerHTML") : '';var html = titleHtml +sumaryHtml +jsonp.ReviewList;jQuery('.Community_Content').html(html);}if (jsonp && jsonp.ItemRating && Biz.ProductReview2017.SyncLoad.isSyncLoad == true) {jQuery('.grpArticle .grpRating:first').html(jsonp.ItemRating);}if (needtoTop == 'need') {Biz.ProductReview2017.Common.scrollToReviewTop();}backgorundOverview.remove();}).fail(function () {Biz.ProductReview2017.PageUrlconfig.initData(oldData);backgorundOverview.remove();});},scrollToReviewTop: function () {jQuery('html, body').animate({scrollTop: jQuery('#search').offset().top -105}, 1000);}};usingNamespace("Biz.ProductReview2017")["SyncLoad"] = {isSyncLoad: false,getQueryStringsCurrent: function () {var result = window.location.href.match(new RegExp("[\?\&][^\?\&]+=[^\?\&]+", "g"));if (result == null) {return "";}for (var i = 0; i < result.length; i++) {result[i] = result[i].substring(1);}return result;},removeReviewAllPara: function () {var lowerLink = window.location.href.toLowerCase();var redirectLink = window.location.href;var allQueryStrings = Biz.ProductReview2017.SyncLoad.getQueryStringsCurrent();if (lowerLink.indexOf('reviews=all') > -1) {var removeorigin = window.location.href.split("?")[0];for (var i = 0; i < allQueryStrings.length; i++) {var queryStrings = allQueryStrings[i].toLowerCase().split("=");if (queryStrings[0] != "reviews") {removeorigin = Biz.ProductReview2017.SyncLoad.buildRedirectLink(removeorigin, allQueryStrings[i]);}}redirectLink = removeorigin;}history.replaceState(null, null, redirectLink);},addReviewAllPara: function () {var lowerLink = window.location.href.toLowerCase();var redirectLink = window.location.href;if (lowerLink.indexOf('reviews=all') == -1) {if (redirectLink.match("[\?]")) {var splValue = window.location.href.split('\?');if (splValue.length > 1) {redirectLink = splValue[0] + '?reviews=all&' + splValue[1];}}else {redirectLink = window.location.href + '?reviews=all';}}history.replaceState(null, null, redirectLink);},buildRedirectLink: function (orgLink, addQueryFilter) {var editedLink = orgLink;if (editedLink.indexOf('?') > -1) { editedLink = (editedLink + "&" + addQueryFilter); }else { editedLink = (editedLink + "?" + addQueryFilter); }return editedLink;},setCurrentReviewAllPara: function () {if (jQuery("#prAllRelatedProduct").is(':checked')) {Biz.ProductReview2017.SyncLoad.addReviewAllPara();} else {Biz.ProductReview2017.SyncLoad.removeReviewAllPara();}}};usingNamespace("Biz.ProductReview2017")["Pagination"] = {prebuttonClick:function() {var cfg = Biz.ProductReview2017.PageConfig;var currentPage = cfg.currentPage;if (currentPage > 1) {Biz.ProductReview2017.Pagination.goToPage(currentPage-1);}},nextbuttonClick: function() {var cfg = Biz.ProductReview2017.PageConfig;var currentPage = cfg.currentPage;var pageCount = cfg.pageCount;if (currentPage < pageCount) {Biz.ProductReview2017.Pagination.goToPage(currentPage + 1);}},pageInputBlur: function() {var pageValue = jQuery('#input_GoToPage').val();if (pageValue) {var num = Number.parse(pageValue);var cfg = Biz.ProductReview2017.PageConfig;var currentPage = cfg.currentPage;var pageCount = cfg.pageCount;if (num < 1) {num = currentPage;jQuery('#input_GoToPage').val(num);}if (num > pageCount) {num = pageCount;jQuery('#input_GoToPage').val(num);}}},pageInputKeyDown: function (event) {if (event.keyCode == 13) {var pageValue = jQuery('#input_GoToPage').val();if (pageValue) {var num = Number.parse(pageValue);var cfg = Biz.ProductReview2017.PageConfig;var currentPage = cfg.currentPage;var pageCount = cfg.pageCount;if (num == currentPage) {return;}if (num < 1) {num = currentPage;jQuery('#input_GoToPage').val(num);}if (num > pageCount) {num = pageCount;jQuery('#input_GoToPage').val(num);}Biz.ProductReview2017.Pagination.goToPage(num);}}},gotoButtonClick: function() {var pageValue = jQuery('#input_GoToPage').val();if (pageValue) {var num = Number.parse(pageValue);var cfg = Biz.ProductReview2017.PageConfig;var currentPage = cfg.currentPage;var pageCount = cfg.pageCount;if (num < 1) {num = currentPage;jQuery('#input_GoToPage').val(num);}if (num > pageCount) {num = pageCount;jQuery('#input_GoToPage').val(num);}if (num == currentPage) {return;}Biz.ProductReview2017.Pagination.goToPage(num);}},goToPage: function (pageNumber) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.Page = pageNumber;Biz.ProductReview2017.Common.submit('need', oldData);},changePageSize: function () {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.Pagesize = jQuery("#reviewPageSize").val();Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('need', oldData);}};usingNamespace("Biz.ProductReview2017")["View"] = {changeOrder: function () {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.SortField = jQuery("#Order_top").val();Biz.ProductReview2017.Common.submit('',oldData);},changeSummaryType: function (type) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.SummaryType = type;Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('',oldData);},checkedAllRelated: function ($this) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();if (jQuery($this).is(':checked')) {Biz.ProductReview2017.PageUrlconfig.chkItemOnlyMark = '';Biz.ProductReview2017.PageUrlconfig.ItemOnlyMark = 'false';} else {Biz.ProductReview2017.PageUrlconfig.chkItemOnlyMark = 'on';Biz.ProductReview2017.PageUrlconfig.ItemOnlyMark = 'true';}Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('',oldData);},checkedVerifiedOwners: function ($this) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();if (jQuery($this).is(':checked')) {Biz.ProductReview2017.PageUrlconfig.chkPurchaseMark = 'on';Biz.ProductReview2017.PageUrlconfig.PurchaseMark = 'true';} else {Biz.ProductReview2017.PageUrlconfig.chkPurchaseMark = '';Biz.ProductReview2017.PageUrlconfig.PurchaseMark = 'false';}Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('', oldData);},checkedMfResponses: function ($this) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();if (jQuery($this).is(':checked')) {Biz.ProductReview2017.PageUrlconfig.chkVendorMark = 'on';Biz.ProductReview2017.PageUrlconfig.VendorMark = 'true';} else {Biz.ProductReview2017.PageUrlconfig.chkVendorMark = '';Biz.ProductReview2017.PageUrlconfig.VendorMark = 'false';}Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('', oldData);},filterReviews: function (rate) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.SelectedRating = rate;Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('',oldData);}};usingNamespace("Biz.ProductReview2017")["Search"] = {keywordTmp: "",hisInDesc: "",oldIns: "",innerSearching: function (n) {var v = jQuery(n).val();v = v.replace(/(^\s*)|(\s*$)/g, "");if (!String.isNullOrEmpty(v)) {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.Keywords = v;Biz.ProductReview2017.PageUrlconfig.Page = 1;Biz.ProductReview2017.Common.submit('',oldData);} else {jQuery(n).val('');}},initInput: function (n) {if (jQuery(n)) {Biz.ProductReview2017.Search.keywordTmp = jQuery(n).val();jQuery(n).val("");};},searchFoucs: function () {Biz.ProductReview2017.Search.initInput('#SrchInDesc_top');},searchKeyDown: function (event) {if (event.keyCode == 13) {Biz.ProductReview2017.Search.innerSearching('#SrchInDesc_top');}},searchButtonClick: function () {Biz.ProductReview2017.Search.innerSearching('#SrchInDesc_top');}};usingNamespace("Biz.ProductReview2017")["SearchFilter"] = {filterRemove: function ($this) {var $removeLink = jQuery($this).attr('removeLink');if ($removeLink) {var defaultValue = new Array();defaultValue['SelectedRating'] = '';defaultValue['SummaryType']    = '0';defaultValue['PurchaseMark']   = '';defaultValue['VideoOnlyMark']  = '';defaultValue['VideoMark']      = '';defaultValue['ItemOnlyMark']   = 'true';defaultValue['Keywords']       = '';defaultValue['VendorMark']     = '';var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.Page = 1;var allQueryStrings = Biz.ProductReview2017.PageUrlconfig.getPostData();if (allQueryStrings != "") {var queryKey = '';var queryValue = '';var queryStrings = allQueryStrings.split('&');for (var i = 0; i < queryStrings.length; i++) {queryKey = queryStrings[i].split("=")[0];if (queryKey == $removeLink && defaultValue[$removeLink] != undefined) {queryValue = defaultValue[$removeLink];queryStrings[i] = $removeLink + '=' + queryValue;break;}}allQueryStrings = queryStrings.join('&');Biz.ProductReview2017.Common.getResponData(Biz.ProductReview2017.PageUrlconfig.OrignalUrl, allQueryStrings, '', oldData);}}},resetClick: function () {var oldData = Biz.ProductReview2017.PageUrlconfig.getData();Biz.ProductReview2017.PageUrlconfig.resetData();Biz.ProductReview2017.Common.submit('', oldData);},};usingNamespace("Biz.ProductReview2017")["PageUrlconfig"] = {OrignalUrl: '',action: '',review: "1",Item: '',SortField: '',SummaryType: '',Pagesize: '',PurchaseMark: '',SelectedRating: '',VideoOnlyMark: '',VendorMark: '',IsFeedbackTab: '',DisplaySpecificReview: '',ItemGroupId: '',Type: '',ItemOnlyMark: '',chkPurchaseMark: '',chkVideoOnlyMark: '',chkVendorMark: '',chkItemOnlyMark:'',Keywords: '',Page:'',getPostData: function () {if (this.SelectedRating && this.SelectedRating != -1) {if (this.SortField == 2) {this.SortField = 0;}if (this.SortField == 3) {this.SortField = 0;}}return 'review=' + this.review +'&Item=' + this.Item +'&SortField=' +  this.SortField +'&SummaryType=' + this.SummaryType +'&Pagesize=' + this.Pagesize +'&PurchaseMark=' + this.PurchaseMark +'&SelectedRating=' + this.SelectedRating +'&VideoOnlyMark=' + this.VideoOnlyMark +'&VendorMark=' + this.VendorMark +'&IsFeedbackTab=' + this.IsFeedbackTab +'&DisplaySpecificReview=' + this.DisplaySpecificReview +'&ItemGroupId=' + this.DisplaySpecificReview +'&Type=' + this.Type +'&ItemOnlyMark=' + this.ItemOnlyMark +(this.chkItemOnlyMark ? ('&chkItemOnlyMark=' + this.chkItemOnlyMark) : '') +(this.chkPurchaseMark ? ('&chkPurchaseMark=' + this.chkPurchaseMark) : '' )+(this.chkVideoOnlyMark ? ('&chkVideoOnlyMark=' + this.chkVideoOnlyMark) : '') +(this.chkVendorMark ? ('&chkVendorMark=' + this.chkVendorMark) : '') +'&Keywords=' + encodeURIComponent(this.Keywords) +'&Page=' + this.Page;},initData: function (data) {this.DisplaySpecificReview = data.DisplaySpecificReview;this.IsFeedbackTab = data.IsFeedbackTab;this.ItemGroupId = data.ItemGroupId;this.ItemOnlyMark = data.ItemOnlyMark;this.Pagesize = data.Pagesize;this.PurchaseMark = data.PurchaseMark;this.SelectedRating = data.SelectedRating;this.SortField = data.SortField;this.SummaryType = data.SummaryType;this.Type = data.Type;this.VendorMark = data.VendorMark;this.VideoOnlyMark = data.VideoOnlyMark;this.Item = data.Item;this.OrignalUrl = data.OrignalUrl;this.Page = data.Page;this.Keywords = data.Keyword;},resetData: function () {this.SelectedRating = '';this.SummaryType = '0';this.PurchaseMark = '';this.VideoOnlyMark = '';this.VideoMark = '';this.ItemOnlyMark = 'true';this.Keywords = '';this.Page = '1';this.VendorMark = '';},getData: function() {return {OrignalUrl: this.OrignalUrl,review: this.review,Item: this.Item,SortField: this.SortField,SummaryType: this.SummaryType,Pagesize: this.Pagesize,PurchaseMark: this.PurchaseMark,SelectedRating: this.SelectedRating,VideoOnlyMark: this.VideoOnlyMark,VendorMark: this.VendorMark,IsFeedbackTab: this.IsFeedbackTab,DisplaySpecificReview: this.DisplaySpecificReview,ItemGroupId: this.ItemGroupId,Type: this.Type,ItemOnlyMark: this.ItemOnlyMark,chkPurchaseMark: this.chkPurchaseMark,chkVideoOnlyMark: this.chkVideoOnlyMark,chkVendorMark: this.chkVendorMark,chkItemOnlyMark: this.chkItemOnlyMark,Keyword: this.Keywords,Page: this.Page,}}};usingNamespace("Biz.ProductReview2017")["ReviewVote"] = {form: "frmVote",iframe: "frameVote",vote: "Vote",didyou: "dyu",yesButton: "ybtn",noButton: "nbtn",msg: "msg",flag: { "reviewId": null, display: false },queue: null,viFrame: function (rid) {var rv = Biz.ProductReview2017.ReviewVote;var fm = rv.iframe + rid;var dv = (rv.flag.reviewId == rid && rv.flag.display) ? "" : "none";Web.UI.Control.setAttribute($(fm), { "style.display": dv });},isLogin: function () {var loginName = Web.StateManager.Cookies.get(Web.StateManager.Cookies.Name.LOGIN, "CONTACTWITH");return !String.isNullOrEmpty(loginName);},submit: function (rid, v, url) {var rv = Biz.ProductReview2017.ReviewVote;if (rv.isLogin()) {var f = rv.form + rid;var fm = rv.iframe + rid;var dyu = rv.didyou + rid;var ybtn = rv.yesButton + rid;var nbtn = rv.noButton + rid;if (!rv.queue) { rv.queue = new rv.submitQueue(rv.showSubmitMessage); };rv.flag = { "reviewId": rid, display: true };Web.UI.Form.setValue(f, rv.vote, v);Web.UI.Control.setAttribute($(fm), { "style.display": "none" });Web.UI.Control.setAttribute($(dyu), { "style.display": "none" });Web.UI.Control.setAttribute($(ybtn), { "style.display": "none" });Web.UI.Control.setAttribute($(nbtn), { "style.display": "none" });rv.queue.excuteSubmit(f, rid);} else {var loginUrl = Web.Config.Environment.SSLPage.Login;if (loginUrl.toLowerCase().indexOf("nextpage") == -1) { loginUrl += "?toJump=1&NextPage=" + url; };window.location.href = loginUrl;};},submitDone: function () {var rv = Biz.ProductReview2017.ReviewVote;if (rv.queue) { rv.queue.submitComplete(); };},showSubmitMessage: function (id) {var rv = Biz.ProductReview2017.ReviewVote;var msg = rv.msg + id;Web.UI.Control.setAttribute($(msg), { "style.display": "inline-block" });},submitQueue: function (callback) {var submits = [];var ids = [];var isSubmiting = false;var excute = function () {isSubmiting = true;var fn = submits[0];if (String.isNullOrEmpty(fn)) { return; };Web.UI.Form.submit(fn);};this.excuteSubmit = function (fn, id) {if (String.isNullOrEmpty(fn) || String.isNullOrEmpty(id)) { return; };submits.queue(fn);ids.queue(id);if (!isSubmiting) { excute(); };};this.submitComplete = function () {submits.dequeue();var id = ids.dequeue();isSubmiting = false;if (callback) { callback(id); };if (submits.length > 0) { excute(); };};}};